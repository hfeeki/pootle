jQuery.easing.jswing=jQuery.easing.swing;
jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(b,a,c,d,e){return jQuery.easing[jQuery.easing.def](b,a,c,d,e)},easeInQuad:function(b,a,c,d,e){return d*(a/=e)*a+c},easeOutQuad:function(b,a,c,d,e){return-d*(a/=e)*(a-2)+c},easeInOutQuad:function(b,a,c,d,e){if((a/=e/2)<1)return d/2*a*a+c;return-d/2*(--a*(a-2)-1)+c},easeInCubic:function(b,a,c,d,e){return d*(a/=e)*a*a+c},easeOutCubic:function(b,a,c,d,e){return d*((a=a/e-1)*a*a+1)+c},easeInOutCubic:function(b,a,c,d,e){if((a/=e/2)<1)return d/
2*a*a*a+c;return d/2*((a-=2)*a*a+2)+c},easeInQuart:function(b,a,c,d,e){return d*(a/=e)*a*a*a+c},easeOutQuart:function(b,a,c,d,e){return-d*((a=a/e-1)*a*a*a-1)+c},easeInOutQuart:function(b,a,c,d,e){if((a/=e/2)<1)return d/2*a*a*a*a+c;return-d/2*((a-=2)*a*a*a-2)+c},easeInQuint:function(b,a,c,d,e){return d*(a/=e)*a*a*a*a+c},easeOutQuint:function(b,a,c,d,e){return d*((a=a/e-1)*a*a*a*a+1)+c},easeInOutQuint:function(b,a,c,d,e){if((a/=e/2)<1)return d/2*a*a*a*a*a+c;return d/2*((a-=2)*a*a*a*a+2)+c},easeInSine:function(b,
a,c,d,e){return-d*Math.cos(a/e*(Math.PI/2))+d+c},easeOutSine:function(b,a,c,d,e){return d*Math.sin(a/e*(Math.PI/2))+c},easeInOutSine:function(b,a,c,d,e){return-d/2*(Math.cos(Math.PI*a/e)-1)+c},easeInExpo:function(b,a,c,d,e){return a==0?c:d*Math.pow(2,10*(a/e-1))+c},easeOutExpo:function(b,a,c,d,e){return a==e?c+d:d*(-Math.pow(2,-10*a/e)+1)+c},easeInOutExpo:function(b,a,c,d,e){if(a==0)return c;if(a==e)return c+d;if((a/=e/2)<1)return d/2*Math.pow(2,10*(a-1))+c;return d/2*(-Math.pow(2,-10*--a)+2)+c},
easeInCirc:function(b,a,c,d,e){return-d*(Math.sqrt(1-(a/=e)*a)-1)+c},easeOutCirc:function(b,a,c,d,e){return d*Math.sqrt(1-(a=a/e-1)*a)+c},easeInOutCirc:function(b,a,c,d,e){if((a/=e/2)<1)return-d/2*(Math.sqrt(1-a*a)-1)+c;return d/2*(Math.sqrt(1-(a-=2)*a)+1)+c},easeInElastic:function(b,a,c,d,e){b=1.70158;var f=0,g=d;if(a==0)return c;if((a/=e)==1)return c+d;f||(f=e*0.3);if(g<Math.abs(d)){g=d;b=f/4}else b=f/(2*Math.PI)*Math.asin(d/g);return-(g*Math.pow(2,10*(a-=1))*Math.sin((a*e-b)*2*Math.PI/f))+c},easeOutElastic:function(b,
a,c,d,e){b=1.70158;var f=0,g=d;if(a==0)return c;if((a/=e)==1)return c+d;f||(f=e*0.3);if(g<Math.abs(d)){g=d;b=f/4}else b=f/(2*Math.PI)*Math.asin(d/g);return g*Math.pow(2,-10*a)*Math.sin((a*e-b)*2*Math.PI/f)+d+c},easeInOutElastic:function(b,a,c,d,e){b=1.70158;var f=0,g=d;if(a==0)return c;if((a/=e/2)==2)return c+d;f||(f=e*0.3*1.5);if(g<Math.abs(d)){g=d;b=f/4}else b=f/(2*Math.PI)*Math.asin(d/g);if(a<1)return-0.5*g*Math.pow(2,10*(a-=1))*Math.sin((a*e-b)*2*Math.PI/f)+c;return g*Math.pow(2,-10*(a-=1))*Math.sin((a*
e-b)*2*Math.PI/f)*0.5+d+c},easeInBack:function(b,a,c,d,e,f){if(f==undefined)f=1.70158;return d*(a/=e)*a*((f+1)*a-f)+c},easeOutBack:function(b,a,c,d,e,f){if(f==undefined)f=1.70158;return d*((a=a/e-1)*a*((f+1)*a+f)+1)+c},easeInOutBack:function(b,a,c,d,e,f){if(f==undefined)f=1.70158;if((a/=e/2)<1)return d/2*a*a*(((f*=1.525)+1)*a-f)+c;return d/2*((a-=2)*a*(((f*=1.525)+1)*a+f)+2)+c},easeInBounce:function(b,a,c,d,e){return d-jQuery.easing.easeOutBounce(b,e-a,0,d,e)+c},easeOutBounce:function(b,a,c,d,e){return(a/=
e)<1/2.75?d*7.5625*a*a+c:a<2/2.75?d*(7.5625*(a-=1.5/2.75)*a+0.75)+c:a<2.5/2.75?d*(7.5625*(a-=2.25/2.75)*a+0.9375)+c:d*(7.5625*(a-=2.625/2.75)*a+0.984375)+c},easeInOutBounce:function(b,a,c,d,e){if(a<e/2)return jQuery.easing.easeInBounce(b,a*2,0,d,e)*0.5+c;return jQuery.easing.easeOutBounce(b,a*2-e,0,d,e)*0.5+d*0.5+c}});(function(b){function a(g){function h(j){var i=RegExp(b.map(j,encodeURIComponent).join("|"),"ig");return function(n){return n.replace(i,decodeURIComponent)}}g=b.extend({unescape:false},g||{});c.encoder=function(j){if(j===true)return function(i){return i};if(typeof j=="string"&&(j=h(j.split("")))||typeof j=="function")return function(i){return j(encodeURIComponent(i))};return encodeURIComponent}(g.unescape)}var c={put:function(g,h){(h||window).location.hash=this.encoder(g)},get:function(g){return(g||
window).location.toString().split("#",2)[1]||""},encoder:encodeURIComponent},d={id:"__jQuery_history",init:function(){var g='<iframe id="'+this.id+'" style="display:none" src="javascript:false;" />';b("body").prepend(g);return this},_document:function(){return b("#"+this.id)[0].contentWindow.document},put:function(g){var h=this._document();h.open();h.close();c.put(g,h)},get:function(){return c.get(this._document())}},e={};e.base={callback:undefined,type:undefined,check:function(){},load:function(){},
init:function(g,h){a(h);f.callback=g;f._options=h;f._init()},_init:function(){},_options:{}};e.timer={_appState:undefined,_init:function(){var g=c.get();f._appState=g;f.callback(g);setInterval(f.check,100)},check:function(){var g=c.get();if(g!=f._appState){f._appState=g;f.callback(g)}},load:function(g){if(g!=f._appState){c.put(g);f._appState=g;f.callback(g)}}};e.iframeTimer={_appState:undefined,_init:function(){var g=c.get();f._appState=g;d.init().put(g);f.callback(g);setInterval(f.check,100)},check:function(){var g=
d.get(),h=c.get();if(h!=g)if(h==f._appState){f._appState=g;c.put(g);f.callback(g)}else{f._appState=h;d.put(h);f.callback(h)}},load:function(g){if(g!=f._appState){c.put(g);d.put(g);f._appState=g;f.callback(g)}}};e.hashchangeEvent={_init:function(){f.callback(c.get());b(window).bind("hashchange",f.check)},check:function(){f.callback(c.get())},load:function(g){c.put(g)}};var f=b.extend({},e.base);f.type=b.browser.msie&&(b.browser.version<8||document.documentMode<8)?"iframeTimer":"onhashchange"in window?
"hashchangeEvent":"timer";b.extend(f,e[f.type]);b.history=f})(jQuery);(function(b){function a(p,q,o,r){r={data:r||(q?q.data:{}),_wrap:q?q._wrap:null,tmpl:null,parent:q||null,nodes:[],calls:j,nest:i,wrap:n,html:k,update:t};p&&b.extend(r,p,{nodes:[],parent:q});if(o){r.tmpl=o;r._ctnt=r._ctnt||r.tmpl(b,r);r.key=++G;(P.length?u:w)[G]=r}return r}function c(p,q,o){var r;o=o?b.map(o,function(x){return typeof x==="string"?p.key?x.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+v+'="'+p.key+'" $2'):x:c(x,p,x._ctnt)}):p;if(q)return o;o=o.join("");o.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,
function(x,A,E,F){r=b(E).get();h(r);if(A)r=d(A).concat(r);if(F)r=r.concat(d(F))});return r?r:d(o)}function d(p){var q=document.createElement("div");q.innerHTML=p;return b.makeArray(q.childNodes)}function e(p){return new Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+b.trim(p).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,
function(q,o,r,x,A,E,F){q=b.tmpl.tag[r];if(!q)throw"Template command not found: "+r;r=q._default||[];if(E&&!/\w$/.test(A)){A+=E;E=""}if(A){A=g(A);F=F?","+g(F)+")":E?")":"";F=E?A.indexOf(".")>-1?A+E:"("+A+").call($item"+F:A;E=E?F:"(typeof("+A+")==='function'?("+A+").call($item):("+A+"))"}else E=F=r.$1||"null";x=g(x);return"');"+q[o?"close":"open"].split("$notnull_1").join(A?"typeof("+A+")!=='undefined' && ("+A+")!=null":"true").split("$1a").join(E).split("$1").join(F).split("$2").join(x?x.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g,
function(L,K,M,H){return(H=H?","+H+")":M?")":"")?"("+K+").call($item"+H:L}):r.$2||"")+"_.push('"})+"');}return _;")}function f(p,q){p._wrap=c(p,true,b.isArray(q)?q:[z.test(q)?q:b(q).html()]).join("")}function g(p){return p?p.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function h(p){function q(K){function M(N){N+=o;D=A[N]=A[N]||a(D,w[D.parent.key+o]||D.parent,null,true)}var H,C=K,D,O;if(O=K.getAttribute(v)){for(;C.parentNode&&(C=C.parentNode).nodeType===1&&!(H=C.getAttribute(v)););if(H!==O){C=C.parentNode?
C.nodeType===11?0:C.getAttribute(v)||0:0;if(!(D=w[O])){D=u[O];D=a(D,w[C]||u[C],null,true);D.key=++G;w[G]=D}J&&M(O)}K.removeAttribute(v)}else if(J&&(D=b.data(K,"tmplItem"))){M(D.key);w[D.key]=D;C=(C=b.data(K.parentNode,"tmplItem"))?C.key:0}if(D){for(H=D;H&&H.key!=C;){H.nodes.push(K);H=H.parent}delete D._ctnt;delete D._wrap;b.data(K,"tmplItem",D)}}var o="_"+J,r,x,A={},E,F,L;E=0;for(F=p.length;E<F;E++)if((r=p[E]).nodeType===1){x=r.getElementsByTagName("*");for(L=x.length-1;L>=0;L--)q(x[L]);q(r)}}function j(p,
q,o,r){if(!p)return P.pop();P.push({_:p,tmpl:q,item:this,data:o,options:r})}function i(p,q,o){return b.tmpl(b.template(p),q,o,this)}function n(p,q){var o=p.options||{};o.wrapped=q;return b.tmpl(b.template(p.tmpl),p.data,o,p.item)}function k(p,q){var o=this._wrap;return b.map(b(b.isArray(o)?o.join(""):o).filter(p||"*"),function(r){if(q)r=r.innerText||r.textContent;else{var x;if(!(x=r.outerHTML)){x=document.createElement("div");x.appendChild(r.cloneNode(true));x=x.innerHTML}r=x}return r})}function t(){var p=
this.nodes;b.tmpl(null,null,null,this).insertBefore(p[0]);b(p).remove()}var s=b.fn.domManip,v="_tmplitem",z=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,w={},u={},y,I={key:0,data:{}},G=0,J=0,P=[];b.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(p,q){b.fn[p]=function(o){var r=[];o=b(o);var x,A,E;x=this.length===1&&this[0].parentNode;y=w||{};if(x&&x.nodeType===11&&x.childNodes.length===1&&o.length===1){o[q](this[0]);r=this}else{A=0;for(E=
o.length;A<E;A++){J=A;x=(A>0?this.clone(true):this).get();b.fn[q].apply(b(o[A]),x);r=r.concat(x)}J=0;r=this.pushStack(r,p,o.selector)}o=y;y=null;b.tmpl.complete(o);return r}});b.fn.extend({tmpl:function(p,q,o){return b.tmpl(this[0],p,q,o)},tmplItem:function(){return b.tmplItem(this[0])},template:function(p){return b.template(p,this[0])},domManip:function(p,q,o){if(p[0]&&p[0].nodeType){for(var r=b.makeArray(arguments),x=p.length,A=0,E;A<x&&!(E=b.data(p[A++],"tmplItem")););if(x>1)r[0]=[b.makeArray(p)];
if(E&&J)r[2]=function(F){b.tmpl.afterManip(this,F,o)};s.apply(this,r)}else s.apply(this,arguments);J=0;y||b.tmpl.complete(w);return this}});b.extend({tmpl:function(p,q,o,r){var x=!r;if(x){r=I;p=b.template[p]||b.template(null,p);u={}}else if(!p){p=r.tmpl;w[r.key]=r;r.nodes=[];r.wrapped&&f(r,r.wrapped);return b(c(r,null,r.tmpl(b,r)))}if(!p)return[];if(typeof q==="function")q=q.call(r||{});o&&o.wrapped&&f(o,o.wrapped);q=b.isArray(q)?b.map(q,function(A){return A?a(o,r,p,A):null}):[a(o,r,p,q)];return x?
b(c(r,null,q)):q},tmplItem:function(p){var q;if(p instanceof b)p=p[0];for(;p&&p.nodeType===1&&!(q=b.data(p,"tmplItem"))&&(p=p.parentNode););return q||I},template:function(p,q){if(q){if(typeof q==="string")q=e(q);else if(q instanceof b)q=q[0]||{};if(q.nodeType)q=b.data(q,"tmpl")||b.data(q,"tmpl",e(q.innerHTML));return typeof p==="string"?b.template[p]=q:q}return p?typeof p!=="string"?b.template(null,p):b.template[p]||b.template(null,z.test(p)?p:b(p)):null},encode:function(p){return(""+p).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});
b.extend(b.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},
open:"if($notnull_1){_.push($.encode($1a));}"},"!":{open:""}},complete:function(){w={}},afterManip:function(p,q,o){var r=q.nodeType===11?b.makeArray(q.childNodes):q.nodeType===1?[q]:[];o.call(p,q);h(r);J++}})})(jQuery);(function(b,a){function c(){}function d(o){p=[o]}function e(o,r,x){return o&&o.apply(r.context||r,x)}function f(o){function r(B){!Q++&&a(function(){S();M&&(J[C]={s:[B]});E&&(B=E.apply(o,[B]));e(o.success,o,[B,u]);e(A,o,[o,u])},0)}function x(B){!Q++&&a(function(){S();M&&B!=y&&(J[C]=B);e(o.error,o,[o,B]);e(A,o,[o,B])},0)}o=b.extend({},q,o);var A=o.complete,E=o.dataFilter,F=o.callbackParameter,L=o.callback,K=o.cache,M=o.pageCache,H=o.charset,C=o.url,D=o.data,O=o.timeout,N,Q=0,S=c;o.abort=function(){!Q++&&
S()};if(e(o.beforeSend,o,[o])===false||Q)return o;C=C||j;D=D?typeof D=="string"?D:b.param(D,o.traditional):j;C+=D?(/\?/.test(C)?"&":"?")+D:j;F&&(C+=(/\?/.test(C)?"&":"?")+encodeURIComponent(F)+"=?");!K&&!M&&(C+=(/\?/.test(C)?"&":"?")+"_"+(new Date).getTime()+"=");C=C.replace(/=\?(&|$)/,"="+L+"$1");M&&(N=J[C])?N.s?r(N.s[0]):x(N):a(function(B,R,T){if(!Q){T=O>0&&a(function(){x(y)},O);S=function(){T&&clearTimeout(T);B[v]=B[k]=B[s]=B[t]=null;G[z](B);R&&G[z](R)};window[L]=d;B=b(w)[0];B.id=n+P++;if(H)B[h]=
H;var V=function(U){(B[k]||c)();U=p;p=undefined;U?r(U[0]):x(i)};if(I.msie){B.event=k;B.htmlFor=B.id;B[v]=function(){/loaded|complete/.test(B.readyState)&&V()}}else{B[t]=B[s]=V;I.opera?(R=b(w)[0]).text="jQuery('#"+B.id+"')[0]."+t+"()":B[g]=g}B.src=C;G.insertBefore(B,G.firstChild);R&&G.insertBefore(R,G.firstChild)}},0);return o}var g="async",h="charset",j="",i="error",n="_jqjsp",k="onclick",t="on"+i,s="onload",v="onreadystatechange",z="removeChild",w="<script/>",u="success",y="timeout",I=b.browser,
G=b("head")[0]||document.documentElement,J={},P=0,p,q={callback:n,url:location.href};f.setup=function(o){b.extend(q,o)};b.jsonp=f})(jQuery,setTimeout);(function(b){b.fn.TextAreaExpander=function(a,c){function d(f){f=f.target||f;var g=f.value.length,h=f.offsetWidth;if(g!=f.valLength||h!=f.boxWidth){if(e&&(g<f.valLength||h!=f.boxWidth))f.style.height="0px";var j=Math.max(f.expandMin,Math.min(f.scrollHeight,f.expandMax));f.style.overflow=f.scrollHeight>j?"auto":"hidden";f.style.height=j+"px";f.valLength=g;f.boxWidth=h}return true}var e=!(b.browser.msie||b.browser.opera);this.each(function(){if(this.nodeName.toLowerCase()=="textarea"){var f=this.className.match(/expand(\d+)\-*(\d+)*/i);
this.expandMin=a||(f?parseInt("0"+f[1],10):0);this.expandMax=c||(f?parseInt("0"+f[2],10):99999);d(this);if(!this.Initialized){this.Initialized=true;b(this).css("padding-top",0).css("padding-bottom",0);b(this).bind("keyup",d).bind("focus",d)}}});return this}})(jQuery);$(document).ready(function(){$("textarea[class*=expand]").TextAreaExpander()});function diff_match_patch(){this.Diff_Timeout=1;this.Diff_EditCost=4;this.Diff_DualThreshold=32;this.Match_Threshold=0.5;this.Match_Distance=1E3;this.Patch_DeleteThreshold=0.5;this.Patch_Margin=4;this.Match_MaxBits=function(){for(var b=0,a=1,c=2;a!=c;){b++;a=c;c<<=1}return b}()}var DIFF_DELETE=-1,DIFF_INSERT=1,DIFF_EQUAL=0;
diff_match_patch.prototype.diff_main=function(b,a,c,d){if(typeof d=="undefined")d=this.Diff_Timeout<=0?Number.MAX_VALUE:(new Date).getTime()+this.Diff_Timeout*1E3;d=d;if(b==null||a==null)throw Error("Null input. (diff_main)");if(b==a){if(b)return[[DIFF_EQUAL,b]];return[]}if(typeof c=="undefined")c=true;var e=c,f=this.diff_commonPrefix(b,a);c=b.substring(0,f);b=b.substring(f);a=a.substring(f);f=this.diff_commonSuffix(b,a);var g=b.substring(b.length-f);b=b.substring(0,b.length-f);a=a.substring(0,a.length-
f);b=this.diff_compute(b,a,e,d);c&&b.unshift([DIFF_EQUAL,c]);g&&b.push([DIFF_EQUAL,g]);this.diff_cleanupMerge(b);return b};
diff_match_patch.prototype.diff_compute=function(b,a,c,d){var e;if(!b)return[[DIFF_INSERT,a]];if(!a)return[[DIFF_DELETE,b]];e=b.length>a.length?b:a;var f=b.length>a.length?a:b,g=e.indexOf(f);if(g!=-1){e=[[DIFF_INSERT,e.substring(0,g)],[DIFF_EQUAL,f],[DIFF_INSERT,e.substring(g+f.length)]];if(b.length>a.length)e[0][0]=e[2][0]=DIFF_DELETE;return e}if(e=this.diff_halfMatch(b,a)){b=e[1];a=e[3];d=e[4];e=this.diff_main(e[0],e[2],c);c=this.diff_main(b,a,c);return e.concat([[DIFF_EQUAL,d]],c)}if(c&&(b.length<
100||a.length<100))c=false;var h;if(c){h=this.diff_linesToChars(b,a);b=h[0];a=h[1];h=h[2]}e=this.diff_map(b,a,d);if(c){this.diff_charsToLines(e,h);this.diff_cleanupSemantic(e);e.push([DIFF_EQUAL,""]);a=b=c=0;for(f=h="";c<e.length;){switch(e[c][0]){case DIFF_INSERT:a++;f+=e[c][1];break;case DIFF_DELETE:b++;h+=e[c][1];break;case DIFF_EQUAL:if(b>=1&&a>=1){h=this.diff_main(h,f,false,d);e.splice(c-b-a,b+a);c=c-b-a;for(b=h.length-1;b>=0;b--)e.splice(c,0,h[b]);c+=h.length}b=a=0;f=h=""}c++}e.pop()}return e};
diff_match_patch.prototype.diff_linesToChars=function(b,a){function c(h){for(var j="",i=0,n=-1,k=d.length;n<h.length-1;){n=h.indexOf("\n",i);if(n==-1)n=h.length-1;var t=h.substring(i,n+1);i=n+1;if(e.hasOwnProperty?e.hasOwnProperty(t):e[t]!==undefined)j+=String.fromCharCode(e[t]);else{j+=String.fromCharCode(k);e[t]=k;d[k++]=t}}return j}var d=[],e={};d[0]="";var f=c(b),g=c(a);return[f,g,d]};
diff_match_patch.prototype.diff_charsToLines=function(b,a){for(var c=0;c<b.length;c++){for(var d=b[c][1],e=[],f=0;f<d.length;f++)e[f]=a[d.charCodeAt(f)];b[c][1]=e.join("")}};
diff_match_patch.prototype.diff_map=function(b,a,c){var d=b.length,e=a.length,f=d+e-1,g=this.Diff_DualThreshold*2<f,h=[],j=[],i={},n={};i[1]=0;n[1]=0;for(var k,t,s,v={},z=false,w=(d+e)%2,u=0;u<f;u++){if((new Date).getTime()>c)break;h[u]={};for(var y=-u;y<=u;y+=2){k=y==-u||y!=u&&i[y-1]<i[y+1]?i[y+1]:i[y-1]+1;t=k-y;if(g){s=k+","+t;if(w&&v[s]!==undefined)z=true;w||(v[s]=u)}for(;!z&&k<d&&t<e&&b.charAt(k)==a.charAt(t);){k++;t++;if(g){s=k+","+t;if(w&&v[s]!==undefined)z=true;w||(v[s]=u)}}i[y]=k;h[u][k+","+
t]=true;if(k==d&&t==e)return this.diff_path1(h,b,a);else if(z){j=j.slice(0,v[s]+1);c=this.diff_path1(h,b.substring(0,k),a.substring(0,t));return c.concat(this.diff_path2(j,b.substring(k),a.substring(t)))}}if(g){j[u]={};for(y=-u;y<=u;y+=2){k=y==-u||y!=u&&n[y-1]<n[y+1]?n[y+1]:n[y-1]+1;t=k-y;s=d-k+","+(e-t);if(!w&&v[s]!==undefined)z=true;if(w)v[s]=u;for(;!z&&k<d&&t<e&&b.charAt(d-k-1)==a.charAt(e-t-1);){k++;t++;s=d-k+","+(e-t);if(!w&&v[s]!==undefined)z=true;if(w)v[s]=u}n[y]=k;j[u][k+","+t]=true;if(z){h=
h.slice(0,v[s]+1);c=this.diff_path1(h,b.substring(0,d-k),a.substring(0,e-t));return c.concat(this.diff_path2(j,b.substring(d-k),a.substring(e-t)))}}}}return[[DIFF_DELETE,b],[DIFF_INSERT,a]]};
diff_match_patch.prototype.diff_path1=function(b,a,c){for(var d=[],e=a.length,f=c.length,g=null,h=b.length-2;h>=0;h--)for(;;)if(b[h][e-1+","+f]!==undefined){e--;if(g===DIFF_DELETE)d[0][1]=a.charAt(e)+d[0][1];else d.unshift([DIFF_DELETE,a.charAt(e)]);g=DIFF_DELETE;break}else if(b[h][e+","+(f-1)]!==undefined){f--;if(g===DIFF_INSERT)d[0][1]=c.charAt(f)+d[0][1];else d.unshift([DIFF_INSERT,c.charAt(f)]);g=DIFF_INSERT;break}else{e--;f--;if(a.charAt(e)!=c.charAt(f))throw Error("No diagonal.  Can't happen. (diff_path1)");
if(g===DIFF_EQUAL)d[0][1]=a.charAt(e)+d[0][1];else d.unshift([DIFF_EQUAL,a.charAt(e)]);g=DIFF_EQUAL}return d};
diff_match_patch.prototype.diff_path2=function(b,a,c){for(var d=[],e=0,f=a.length,g=c.length,h=null,j=b.length-2;j>=0;j--)for(;;)if(b[j][f-1+","+g]!==undefined){f--;if(h===DIFF_DELETE)d[e-1][1]+=a.charAt(a.length-f-1);else d[e++]=[DIFF_DELETE,a.charAt(a.length-f-1)];h=DIFF_DELETE;break}else if(b[j][f+","+(g-1)]!==undefined){g--;if(h===DIFF_INSERT)d[e-1][1]+=c.charAt(c.length-g-1);else d[e++]=[DIFF_INSERT,c.charAt(c.length-g-1)];h=DIFF_INSERT;break}else{f--;g--;if(a.charAt(a.length-f-1)!=c.charAt(c.length-
g-1))throw Error("No diagonal.  Can't happen. (diff_path2)");if(h===DIFF_EQUAL)d[e-1][1]+=a.charAt(a.length-f-1);else d[e++]=[DIFF_EQUAL,a.charAt(a.length-f-1)];h=DIFF_EQUAL}return d};diff_match_patch.prototype.diff_commonPrefix=function(b,a){if(!b||!a||b.charAt(0)!=a.charAt(0))return 0;for(var c=0,d=Math.min(b.length,a.length),e=d,f=0;c<e;){if(b.substring(f,e)==a.substring(f,e))f=c=e;else d=e;e=Math.floor((d-c)/2+c)}return e};
diff_match_patch.prototype.diff_commonSuffix=function(b,a){if(!b||!a||b.charAt(b.length-1)!=a.charAt(a.length-1))return 0;for(var c=0,d=Math.min(b.length,a.length),e=d,f=0;c<e;){if(b.substring(b.length-e,b.length-f)==a.substring(a.length-e,a.length-f))f=c=e;else d=e;e=Math.floor((d-c)/2+c)}return e};
diff_match_patch.prototype.diff_commonOverlap=function(b,a){var c=b.length,d=a.length;if(c==0||d==0)return 0;if(c>d)b=b.substring(c-d);else if(c<d)a=a.substring(0,c);c=Math.min(c,d);if(b==a)return c;d=0;for(var e=1;;){var f=b.substring(c-e);f=a.indexOf(f);if(f==-1)return d;e+=f;if(f==0||b.substring(c-e)==a.substring(0,e)){d=e;e++}}};
diff_match_patch.prototype.diff_halfMatch=function(b,a){function c(i,n,k){for(var t=i.substring(k,k+Math.floor(i.length/4)),s=-1,v="",z,w,u,y;(s=n.indexOf(t,s+1))!=-1;){var I=f.diff_commonPrefix(i.substring(k),n.substring(s)),G=f.diff_commonSuffix(i.substring(0,k),n.substring(0,s));if(v.length<G+I){v=n.substring(s-G,s)+n.substring(s,s+I);z=i.substring(0,k-G);w=i.substring(k+I);u=n.substring(0,s-G);y=n.substring(s+I)}}return v.length>=i.length/2?[z,w,u,y,v]:null}var d=b.length>a.length?b:a,e=b.length>
a.length?a:b;if(d.length<4||e.length*2<d.length)return null;var f=this,g=c(d,e,Math.ceil(d.length/4));d=c(d,e,Math.ceil(d.length/2));if(!g&&!d)return null;else g=d?g?g[4].length>d[4].length?g:d:d:g;var h,j;if(b.length>a.length){d=g[0];e=g[1];h=g[2];j=g[3]}else{h=g[0];j=g[1];d=g[2];e=g[3]}return[d,e,h,j,g[4]]};
diff_match_patch.prototype.diff_cleanupSemantic=function(b){for(var a=false,c=[],d=0,e=null,f=0,g=0,h=0,j=0,i=0;f<b.length;){if(b[f][0]==DIFF_EQUAL){c[d++]=f;g=j;h=i;i=j=0;e=b[f][1]}else{if(b[f][0]==DIFF_INSERT)j+=b[f][1].length;else i+=b[f][1].length;if(e!==null&&e.length<=Math.max(g,h)&&e.length<=Math.max(j,i)){b.splice(c[d-1],0,[DIFF_DELETE,e]);b[c[d-1]+1][0]=DIFF_INSERT;d--;d--;f=d>0?c[d-1]:-1;i=j=h=g=0;e=null;a=true}}f++}a&&this.diff_cleanupMerge(b);this.diff_cleanupSemanticLossless(b);for(f=
1;f<b.length;){if(b[f-1][0]==DIFF_DELETE&&b[f][0]==DIFF_INSERT){a=b[f-1][1];c=b[f][1];if(d=this.diff_commonOverlap(a,c)){b.splice(f,0,[DIFF_EQUAL,c.substring(0,d)]);b[f-1][1]=a.substring(0,a.length-d);b[f+1][1]=c.substring(d);f++}f++}f++}};
diff_match_patch.prototype.diff_cleanupSemanticLossless=function(b){function a(w,u){if(!w||!u)return 5;var y=0;if(w.charAt(w.length-1).match(c)||u.charAt(0).match(c)){y++;if(w.charAt(w.length-1).match(d)||u.charAt(0).match(d)){y++;if(w.charAt(w.length-1).match(e)||u.charAt(0).match(e)){y++;if(w.match(f)||u.match(g))y++}}}return y}for(var c=/[^a-zA-Z0-9]/,d=/\s/,e=/[\r\n]/,f=/\n\r?\n$/,g=/^\r?\n\r?\n/,h=1;h<b.length-1;){if(b[h-1][0]==DIFF_EQUAL&&b[h+1][0]==DIFF_EQUAL){var j=b[h-1][1],i=b[h][1],n=b[h+
1][1],k=this.diff_commonSuffix(j,i);if(k){var t=i.substring(i.length-k);j=j.substring(0,j.length-k);i=t+i.substring(0,i.length-k);n=t+n}k=j;t=i;for(var s=n,v=a(j,i)+a(i,n);i.charAt(0)===n.charAt(0);){j+=i.charAt(0);i=i.substring(1)+n.charAt(0);n=n.substring(1);var z=a(j,i)+a(i,n);if(z>=v){v=z;k=j;t=i;s=n}}if(b[h-1][1]!=k){if(k)b[h-1][1]=k;else{b.splice(h-1,1);h--}b[h][1]=t;if(s)b[h+1][1]=s;else{b.splice(h+1,1);h--}}}h++}};
diff_match_patch.prototype.diff_cleanupEfficiency=function(b){for(var a=false,c=[],d=0,e="",f=0,g=false,h=false,j=false,i=false;f<b.length;){if(b[f][0]==DIFF_EQUAL){if(b[f][1].length<this.Diff_EditCost&&(j||i)){c[d++]=f;g=j;h=i;e=b[f][1]}else{d=0;e=""}j=i=false}else{if(b[f][0]==DIFF_DELETE)i=true;else j=true;if(e&&(g&&h&&j&&i||e.length<this.Diff_EditCost/2&&g+h+j+i==3)){b.splice(c[d-1],0,[DIFF_DELETE,e]);b[c[d-1]+1][0]=DIFF_INSERT;d--;e="";if(g&&h){j=i=true;d=0}else{d--;f=d>0?c[d-1]:-1;j=i=false}a=
true}}f++}a&&this.diff_cleanupMerge(b)};
diff_match_patch.prototype.diff_cleanupMerge=function(b){b.push([DIFF_EQUAL,""]);for(var a=0,c=0,d=0,e="",f="",g;a<b.length;)switch(b[a][0]){case DIFF_INSERT:d++;f+=b[a][1];a++;break;case DIFF_DELETE:c++;e+=b[a][1];a++;break;case DIFF_EQUAL:if(c+d>1){if(c!==0&&d!==0){g=this.diff_commonPrefix(f,e);if(g!==0){if(a-c-d>0&&b[a-c-d-1][0]==DIFF_EQUAL)b[a-c-d-1][1]+=f.substring(0,g);else{b.splice(0,0,[DIFF_EQUAL,f.substring(0,g)]);a++}f=f.substring(g);e=e.substring(g)}g=this.diff_commonSuffix(f,e);if(g!==
0){b[a][1]=f.substring(f.length-g)+b[a][1];f=f.substring(0,f.length-g);e=e.substring(0,e.length-g)}}if(c===0)b.splice(a-c-d,c+d,[DIFF_INSERT,f]);else d===0?b.splice(a-c-d,c+d,[DIFF_DELETE,e]):b.splice(a-c-d,c+d,[DIFF_DELETE,e],[DIFF_INSERT,f]);a=a-c-d+(c?1:0)+(d?1:0)+1}else if(a!==0&&b[a-1][0]==DIFF_EQUAL){b[a-1][1]+=b[a][1];b.splice(a,1)}else a++;c=d=0;f=e=""}b[b.length-1][1]===""&&b.pop();c=false;for(a=1;a<b.length-1;){if(b[a-1][0]==DIFF_EQUAL&&b[a+1][0]==DIFF_EQUAL)if(b[a][1].substring(b[a][1].length-
b[a-1][1].length)==b[a-1][1]){b[a][1]=b[a-1][1]+b[a][1].substring(0,b[a][1].length-b[a-1][1].length);b[a+1][1]=b[a-1][1]+b[a+1][1];b.splice(a-1,1);c=true}else if(b[a][1].substring(0,b[a+1][1].length)==b[a+1][1]){b[a-1][1]+=b[a+1][1];b[a][1]=b[a][1].substring(b[a+1][1].length)+b[a+1][1];b.splice(a+1,1);c=true}a++}c&&this.diff_cleanupMerge(b)};
diff_match_patch.prototype.diff_xIndex=function(b,a){var c=0,d=0,e=0,f=0,g;for(g=0;g<b.length;g++){if(b[g][0]!==DIFF_INSERT)c+=b[g][1].length;if(b[g][0]!==DIFF_DELETE)d+=b[g][1].length;if(c>a)break;e=c;f=d}if(b.length!=g&&b[g][0]===DIFF_DELETE)return f;return f+(a-e)};
diff_match_patch.prototype.diff_prettyHtml=function(b){for(var a=[],c=0,d=/&/g,e=/</g,f=/>/g,g=/\n/g,h=0;h<b.length;h++){var j=b[h][0],i=b[h][1],n=i.replace(d,"&amp;").replace(e,"&lt;").replace(f,"&gt;").replace(g,"&para;<BR>");switch(j){case DIFF_INSERT:a[h]='<INS STYLE="background:#E6FFE6;" TITLE="i='+c+'">'+n+"</INS>";break;case DIFF_DELETE:a[h]='<DEL STYLE="background:#FFE6E6;" TITLE="i='+c+'">'+n+"</DEL>";break;case DIFF_EQUAL:a[h]='<SPAN TITLE="i='+c+'">'+n+"</SPAN>"}if(j!==DIFF_DELETE)c+=i.length}return a.join("")};
diff_match_patch.prototype.diff_text1=function(b){for(var a=[],c=0;c<b.length;c++)if(b[c][0]!==DIFF_INSERT)a[c]=b[c][1];return a.join("")};diff_match_patch.prototype.diff_text2=function(b){for(var a=[],c=0;c<b.length;c++)if(b[c][0]!==DIFF_DELETE)a[c]=b[c][1];return a.join("")};
diff_match_patch.prototype.diff_levenshtein=function(b){for(var a=0,c=0,d=0,e=0;e<b.length;e++){var f=b[e][1];switch(b[e][0]){case DIFF_INSERT:c+=f.length;break;case DIFF_DELETE:d+=f.length;break;case DIFF_EQUAL:a+=Math.max(c,d);d=c=0}}a+=Math.max(c,d);return a};
diff_match_patch.prototype.diff_toDelta=function(b){for(var a=[],c=0;c<b.length;c++)switch(b[c][0]){case DIFF_INSERT:a[c]="+"+encodeURI(b[c][1]);break;case DIFF_DELETE:a[c]="-"+b[c][1].length;break;case DIFF_EQUAL:a[c]="="+b[c][1].length}return a.join("\t").replace(/%20/g," ")};
diff_match_patch.prototype.diff_fromDelta=function(b,a){for(var c=[],d=0,e=0,f=a.split(/\t/g),g=0;g<f.length;g++){var h=f[g].substring(1);switch(f[g].charAt(0)){case "+":try{c[d++]=[DIFF_INSERT,decodeURI(h)]}catch(j){throw Error("Illegal escape in diff_fromDelta: "+h);}break;case "-":case "=":var i=parseInt(h,10);if(isNaN(i)||i<0)throw Error("Invalid number in diff_fromDelta: "+h);h=b.substring(e,e+=i);if(f[g].charAt(0)=="=")c[d++]=[DIFF_EQUAL,h];else c[d++]=[DIFF_DELETE,h];break;default:if(f[g])throw Error("Invalid diff operation in diff_fromDelta: "+
f[g]);}}if(e!=b.length)throw Error("Delta length ("+e+") does not equal source text length ("+b.length+").");return c};diff_match_patch.prototype.match_main=function(b,a,c){if(b==null||a==null||c==null)throw Error("Null input. (match_main)");c=Math.max(0,Math.min(c,b.length));return b==a?0:b.length?b.substring(c,c+a.length)==a?c:this.match_bitap(b,a,c):-1};
diff_match_patch.prototype.match_bitap=function(b,a,c){function d(w,u){var y=w/a.length,I=Math.abs(c-u);if(!f.Match_Distance)return I?1:y;return y+I/f.Match_Distance}if(a.length>this.Match_MaxBits)throw Error("Pattern too long for this browser.");var e=this.match_alphabet(a),f=this,g=this.Match_Threshold,h=b.indexOf(a,c);if(h!=-1){g=Math.min(d(0,h),g);h=b.lastIndexOf(a,c+a.length);if(h!=-1)g=Math.min(d(0,h),g)}var j=1<<a.length-1;h=-1;for(var i,n,k=a.length+b.length,t,s=0;s<a.length;s++){i=0;for(n=
k;i<n;){if(d(s,c+n)<=g)i=n;else k=n;n=Math.floor((k-i)/2+i)}k=n;i=Math.max(1,c-n+1);var v=Math.min(c+n,b.length)+a.length;n=Array(v+2);n[v+1]=(1<<s)-1;for(v=v;v>=i;v--){var z=e[b.charAt(v-1)];n[v]=s===0?(n[v+1]<<1|1)&z:(n[v+1]<<1|1)&z|(t[v+1]|t[v])<<1|1|t[v+1];if(n[v]&j){z=d(s,v-1);if(z<=g){g=z;h=v-1;if(h>c)i=Math.max(1,2*c-h);else break}}}if(d(s+1,c)>g)break;t=n}return h};
diff_match_patch.prototype.match_alphabet=function(b){for(var a={},c=0;c<b.length;c++)a[b.charAt(c)]=0;for(c=0;c<b.length;c++)a[b.charAt(c)]|=1<<b.length-c-1;return a};
diff_match_patch.prototype.patch_addContext=function(b,a){if(a.length!=0){for(var c=a.substring(b.start2,b.start2+b.length1),d=0;a.indexOf(c)!=a.lastIndexOf(c)&&c.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;){d+=this.Patch_Margin;c=a.substring(b.start2-d,b.start2+b.length1+d)}d+=this.Patch_Margin;(c=a.substring(b.start2-d,b.start2))&&b.diffs.unshift([DIFF_EQUAL,c]);(d=a.substring(b.start2+b.length1,b.start2+b.length1+d))&&b.diffs.push([DIFF_EQUAL,d]);b.start1-=c.length;b.start2-=
c.length;b.length1+=c.length+d.length;b.length2+=c.length+d.length}};
diff_match_patch.prototype.patch_make=function(b,a,c){var d;if(typeof b=="string"&&typeof a=="string"&&typeof c=="undefined"){d=b;a=this.diff_main(d,a,true);if(a.length>2){this.diff_cleanupSemantic(a);this.diff_cleanupEfficiency(a)}}else if(b&&typeof b=="object"&&typeof a=="undefined"&&typeof c=="undefined"){a=b;d=this.diff_text1(a)}else if(typeof b=="string"&&a&&typeof a=="object"&&typeof c=="undefined"){d=b;a=a}else if(typeof b=="string"&&typeof a=="string"&&c&&typeof c=="object"){d=b;a=c}else throw Error("Unknown call format to patch_make.");
if(a.length===0)return[];c=[];b=new patch_obj;var e=0,f=0,g=0,h=d;d=d;for(var j=0;j<a.length;j++){var i=a[j][0],n=a[j][1];if(!e&&i!==DIFF_EQUAL){b.start1=f;b.start2=g}switch(i){case DIFF_INSERT:b.diffs[e++]=a[j];b.length2+=n.length;d=d.substring(0,g)+n+d.substring(g);break;case DIFF_DELETE:b.length1+=n.length;b.diffs[e++]=a[j];d=d.substring(0,g)+d.substring(g+n.length);break;case DIFF_EQUAL:if(n.length<=2*this.Patch_Margin&&e&&a.length!=j+1){b.diffs[e++]=a[j];b.length1+=n.length;b.length2+=n.length}else if(n.length>=
2*this.Patch_Margin)if(e){this.patch_addContext(b,h);c.push(b);b=new patch_obj;e=0;h=d;f=g}}if(i!==DIFF_INSERT)f+=n.length;if(i!==DIFF_DELETE)g+=n.length}if(e){this.patch_addContext(b,h);c.push(b)}return c};diff_match_patch.prototype.patch_deepCopy=function(b){for(var a=[],c=0;c<b.length;c++){var d=b[c],e=new patch_obj;e.diffs=[];for(var f=0;f<d.diffs.length;f++)e.diffs[f]=d.diffs[f].slice();e.start1=d.start1;e.start2=d.start2;e.length1=d.length1;e.length2=d.length2;a[c]=e}return a};
diff_match_patch.prototype.patch_apply=function(b,a){if(b.length==0)return[a,[]];b=this.patch_deepCopy(b);var c=this.patch_addPadding(b);a=c+a+c;this.patch_splitMax(b);for(var d=0,e=[],f=0;f<b.length;f++){var g=b[f].start2+d,h=this.diff_text1(b[f].diffs),j,i=-1;if(h.length>this.Match_MaxBits){j=this.match_main(a,h.substring(0,this.Match_MaxBits),g);if(j!=-1){i=this.match_main(a,h.substring(h.length-this.Match_MaxBits),g+h.length-this.Match_MaxBits);if(i==-1||j>=i)j=-1}}else j=this.match_main(a,h,
g);if(j==-1){e[f]=false;d-=b[f].length2-b[f].length1}else{e[f]=true;d=j-g;g=i==-1?a.substring(j,j+h.length):a.substring(j,i+this.Match_MaxBits);if(h==g)a=a.substring(0,j)+this.diff_text2(b[f].diffs)+a.substring(j+h.length);else{g=this.diff_main(h,g,false);if(h.length>this.Match_MaxBits&&this.diff_levenshtein(g)/h.length>this.Patch_DeleteThreshold)e[f]=false;else{this.diff_cleanupSemanticLossless(g);h=0;var n;for(i=0;i<b[f].diffs.length;i++){var k=b[f].diffs[i];if(k[0]!==DIFF_EQUAL)n=this.diff_xIndex(g,
h);if(k[0]===DIFF_INSERT)a=a.substring(0,j+n)+k[1]+a.substring(j+n);else if(k[0]===DIFF_DELETE)a=a.substring(0,j+n)+a.substring(j+this.diff_xIndex(g,h+k[1].length));if(k[0]!==DIFF_DELETE)h+=k[1].length}}}}}a=a.substring(c.length,a.length-c.length);return[a,e]};
diff_match_patch.prototype.patch_addPadding=function(b){for(var a=this.Patch_Margin,c="",d=1;d<=a;d++)c+=String.fromCharCode(d);for(d=0;d<b.length;d++){b[d].start1+=a;b[d].start2+=a}d=b[0];var e=d.diffs;if(e.length==0||e[0][0]!=DIFF_EQUAL){e.unshift([DIFF_EQUAL,c]);d.start1-=a;d.start2-=a;d.length1+=a;d.length2+=a}else if(a>e[0][1].length){var f=a-e[0][1].length;e[0][1]=c.substring(e[0][1].length)+e[0][1];d.start1-=f;d.start2-=f;d.length1+=f;d.length2+=f}d=b[b.length-1];e=d.diffs;if(e.length==0||
e[e.length-1][0]!=DIFF_EQUAL){e.push([DIFF_EQUAL,c]);d.length1+=a;d.length2+=a}else if(a>e[e.length-1][1].length){f=a-e[e.length-1][1].length;e[e.length-1][1]+=c.substring(0,f);d.length1+=f;d.length2+=f}return c};
diff_match_patch.prototype.patch_splitMax=function(b){for(var a=this.Match_MaxBits,c=0;c<b.length;c++)if(b[c].length1>a){var d=b[c];b.splice(c--,1);for(var e=d.start1,f=d.start2,g="";d.diffs.length!==0;){var h=new patch_obj,j=true;h.start1=e-g.length;h.start2=f-g.length;if(g!==""){h.length1=h.length2=g.length;h.diffs.push([DIFF_EQUAL,g])}for(;d.diffs.length!==0&&h.length1<a-this.Patch_Margin;){g=d.diffs[0][0];var i=d.diffs[0][1];if(g===DIFF_INSERT){h.length2+=i.length;f+=i.length;h.diffs.push(d.diffs.shift());
j=false}else if(g===DIFF_DELETE&&h.diffs.length==1&&h.diffs[0][0]==DIFF_EQUAL&&i.length>2*a){h.length1+=i.length;e+=i.length;j=false;h.diffs.push([g,i]);d.diffs.shift()}else{i=i.substring(0,a-h.length1-this.Patch_Margin);h.length1+=i.length;e+=i.length;if(g===DIFF_EQUAL){h.length2+=i.length;f+=i.length}else j=false;h.diffs.push([g,i]);if(i==d.diffs[0][1])d.diffs.shift();else d.diffs[0][1]=d.diffs[0][1].substring(i.length)}}g=this.diff_text2(h.diffs);g=g.substring(g.length-this.Patch_Margin);i=this.diff_text1(d.diffs).substring(0,
this.Patch_Margin);if(i!==""){h.length1+=i.length;h.length2+=i.length;if(h.diffs.length!==0&&h.diffs[h.diffs.length-1][0]===DIFF_EQUAL)h.diffs[h.diffs.length-1][1]+=i;else h.diffs.push([DIFF_EQUAL,i])}j||b.splice(++c,0,h)}}};diff_match_patch.prototype.patch_toText=function(b){for(var a=[],c=0;c<b.length;c++)a[c]=b[c];return a.join("")};
diff_match_patch.prototype.patch_fromText=function(b){var a=[];if(!b)return a;b=b.split("\n");for(var c=0,d=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;c<b.length;){var e=b[c].match(d);if(!e)throw Error("Invalid patch string: "+b[c]);var f=new patch_obj;a.push(f);f.start1=parseInt(e[1],10);if(e[2]===""){f.start1--;f.length1=1}else if(e[2]=="0")f.length1=0;else{f.start1--;f.length1=parseInt(e[2],10)}f.start2=parseInt(e[3],10);if(e[4]===""){f.start2--;f.length2=1}else if(e[4]=="0")f.length2=0;else{f.start2--;
f.length2=parseInt(e[4],10)}for(c++;c<b.length;){e=b[c].charAt(0);try{var g=decodeURI(b[c].substring(1))}catch(h){throw Error("Illegal escape in patch_fromText: "+g);}if(e=="-")f.diffs.push([DIFF_DELETE,g]);else if(e=="+")f.diffs.push([DIFF_INSERT,g]);else if(e==" ")f.diffs.push([DIFF_EQUAL,g]);else if(e=="@")break;else if(e!=="")throw Error('Invalid patch mode "'+e+'" in: '+g);c++}}return a};function patch_obj(){this.diffs=[];this.start2=this.start1=null;this.length2=this.length1=0}
patch_obj.prototype.toString=function(){for(var b=["@@ -"+(this.length1===0?this.start1+",0":this.length1==1?this.start1+1:this.start1+1+","+this.length1)+" +"+(this.length2===0?this.start2+",0":this.length2==1?this.start2+1:this.start2+1+","+this.length2)+" @@\n"],a,c=0;c<this.diffs.length;c++){switch(this.diffs[c][0]){case DIFF_INSERT:a="+";break;case DIFF_DELETE:a="-";break;case DIFF_EQUAL:a=" "}b[c+1]=a+encodeURI(this.diffs[c][1])+"\n"}return b.join("").replace(/%20/g," ")};
window.diff_match_patch=diff_match_patch;window.patch_obj=patch_obj;window.DIFF_DELETE=DIFF_DELETE;window.DIFF_INSERT=DIFF_INSERT;window.DIFF_EQUAL=DIFF_EQUAL;(function(b){window.PTL=window.PTL||{};PTL.utils={getHash:function(a){return(a||window).location.toString().split("#",2)[1]||""},decodeURIParameter:function(a){return decodeURIComponent(a.replace(/\+/g," "))},getParsedHash:function(a){var c={},d=/([^&;=]+)=?([^&;]*)/g;if(a==undefined)a=this.getHash();for(var e;e=d.exec(a);)c[this.decodeURIParameter(e[1])]=this.decodeURIParameter(e[2]);return c},updateHashPart:function(a,c,d){for(var e=[],f=/([^&;=]+)=?([^&;]*)/g,g=this.getHash(),h,j;h=f.exec(g);){var i=
this.decodeURIParameter(h[1]);if(i==a){e.push(h[1]+"="+encodeURIComponent(c));j=true}else b.inArray(i,d)==-1&&e.push(h[1]+"="+h[2])}j||e.push(encodeURIComponent(a)+"="+encodeURIComponent(c));return e.join("&")}};Object.size=function(a){var c=0,d;for(d in a)a.hasOwnProperty(d)&&c++;return c};PTL.editor={init:function(a){this.settings={secure:false,mt:[]};a&&b.extend(this.settings,a);this.units={};this.store=b("div#pootle_path").text();this.directory=b("div#directory").text();this.currentPage=1;this.currentNumPages=
0;this.pagesGot={};this.filter="all";this.checks=[];this.ctxtGap=0;this.preventNavigation=this.keepState=false;this.isLoading=true;this.showActivity();this.searchFields=[];this.searchOptions=["source","target","notes","locations"];this.cpRE=/^(<[^>]+>|\[n\|t]|\W$^\n)*(\b|$)/gm;this.escapeRE=/<[^<]*?>|\r\n|[\r\n\t&<>]/gm;this.searchRE=/^in:.+|\sin:.+/i;this.tmReq=null;this.differencer=new diff_match_patch;this.tmpl={vUnit:b.template(b("#view_unit").html()),tm:b.template(b("#tm_suggestions").html())};
this.focused=b(".translate-original-focus textarea").get(0);b("textarea.translation").live("keyup blur",function(){!PTL.editor.keepState&&b(this).attr("defaultValue")!=b(this).val()&&PTL.editor.ungoFuzzy()});b("input.fuzzycheck").live("click",function(){PTL.editor.isFuzzy()?PTL.editor.doFuzzyArea():PTL.editor.undoFuzzyArea()});b(".switch-suggest-mode a").live("click",function(){PTL.editor.toggleSuggestMode();return false});b(".focusthis").live("focus",function(c){PTL.editor.focused=c.target});b(".writetm, .writespecial, .translate-full .highlight-escape, .translate-full .highlight-html").live("click",
this.copyText);b("a.copyoriginal").live("click",function(){var c=b(".translation-text",b(this).parent().parent().parent());PTL.editor.copyOriginal(c)});b("div.suggestion").live("click",function(){if(PTL.editor.getSelectedText()==""){var c=b(".suggestion-translation",this);PTL.editor.copyOriginal(c)}});b("table.translate-table").live("editor_ready",this.ready);b("tr.view-row").live("click",this.gotoUnit);b("input#item-number").live("keypress",function(c){c.keyCode==13&&PTL.editor.gotoPage()});b("input.submit, input.suggest").live("click",
this.processSubmit);b("input.previous, input.next").live("click",this.gotoPrevNext);b("#suggestion-container .rejectsugg").live("click",this.rejectSuggestion);b("#suggestion-container .acceptsugg").live("click",this.acceptSuggestion);b("#translate-checks-block .rejectcheck").live("click",this.rejectCheck);b("div#filter-status select").live("change",this.filterStatus);b("div#filter-checks select").live("change",this.filterChecks);b("a.morecontext").live("click",this.getMoreContext);b("input#id_search").live("keypress",
function(c){if(c.keyCode==13){c.preventDefault();PTL.editor.search()}});shortcut.add("ctrl+return",function(){PTL.editor.isSuggestMode()?b("input.suggest").trigger("click"):b("input.submit").trigger("click")});shortcut.add("ctrl+space",function(c){c&&c.preventDefault&&c.preventDefault();PTL.editor.keepState=true;PTL.editor.isFuzzy()?PTL.editor.ungoFuzzy():PTL.editor.goFuzzy()});shortcut.add("ctrl+shift+space",function(){PTL.editor.toggleSuggestMode()});shortcut.add("ctrl+up",function(){b("input.previous").trigger("click")});
shortcut.add("ctrl+down",function(){b("input.next").trigger("click")});shortcut.add("ctrl+shift+u",function(){b("input#item-number").focus().select()});shortcut.add("ctrl+shift+s",function(){b("#id_search").focus().select()});b("#id_search").focus(function(){b(this).attr("focused",true)});b("#id_search").blur(function(){b(this).attr("focused","")});shortcut.add("escape",function(){b("#id_search").attr("focused")&&b("#id_search").blur()});b(document).ajaxStart(function(){clearTimeout(PTL.editor.delayedActivityTimer);
PTL.editor.delayedActivityTimer=setTimeout(function(){PTL.editor.showActivity()},3E3)});b(document).ajaxStop(function(){clearTimeout(PTL.editor.delayedActivityTimer);PTL.editor.isLoading||PTL.editor.hideActivity()});b.each(this.settings.mt,function(){var c=this.name;b.ajax({url:m("js/mt/"+c+".js"),async:false,dataType:"script",success:function(){setTimeout(function(){PTL.editor.mt[c].init()},0);b("table.translate-table").live("mt_ready",PTL.editor.mt[c].ready)}})});setTimeout(function(){b.history.init(function(c){c=
PTL.utils.getParsedHash(c);var d=false,e=undefined;if("unit"in c){var f=parseInt(c.unit);if(f&&!isNaN(f))if(PTL.editor.activeUid!=f&&PTL.editor.units[f]==undefined){PTL.editor.activeUid=f;d=true}else{PTL.editor.activeUid=f;PTL.editor.displayEditUnit(f);return}}else if("page"in c)if((f=parseInt(c.page))&&!isNaN(f)&&f>0)e=f;if("filter"in c){PTL.editor.prevChecks=PTL.editor.checks;PTL.editor.prevFilter=PTL.editor.filter;f=c.filter.split(",");PTL.editor.filter=f.shift();PTL.editor.checks=PTL.editor.filter==
"checks"?f:[]}if("search"in c){PTL.editor.filter="search";PTL.editor.searchText=c.search;if("sfields"in c)PTL.editor.searchFields=c.sfields.split(",")}PTL.editor.preventNavigation=true;b("div#filter-status select [value='"+PTL.editor.filter+"']").attr("selected","selected");if(PTL.editor.filter=="checks"){b("div#filter-checks").length==0&&PTL.editor.filterStatus();b("div#filter-checks select [value='"+PTL.editor.checks[0]+"']").attr("selected","selected")}if(PTL.editor.filter=="search"){b("#id_search").triggerHandler("focus");
b("#id_search").val(PTL.editor.searchText);b("div.advancedsearch input").each(function(){b.inArray(b(this).val(),PTL.editor.searchFields)>=0?b(this).attr("checked","checked"):b(this).removeAttr("checked")})}PTL.editor.preventNavigation=false;PTL.editor.getViewUnits({pager:true,page:e,withUid:d});if(PTL.editor.hasResults){PTL.editor.fetchPages(false);PTL.editor.displayEditUnit(PTL.editor.activeUid)}},{unescape:true})},1)},ready:function(){var a=b(window).height()*0.3;b("textarea.expanding").TextAreaExpander("10",
a);b(".focusthis").get(0)&&b(".focusthis").get(0).focus();PTL.editor.hlSearch();PTL.editor.settings.tmUrl!=""&&PTL.editor.getTMUnits();b("table.translate-table").trigger("mt_ready");PTL.editor.isLoading=false;PTL.editor.hideActivity();clearTimeout(PTL.editor.delayedActivityTimer)},escapeUnsafeRegexSymbols:function(a){var c;for(c=0;c<19;c++)a=a.replace(RegExp("\\"+"\\.+*?[^]$(){}=!<>\u00a6:".charAt(c),"g"),"\\"+"\\.+*?[^]$(){}=!<>\u00a6:".charAt(c));return a},makeRegexForMultipleWords:function(a){var c=
a.split(" ");for(a=0;a<c.length;a++)c[a]=this.escapeUnsafeRegexSymbols(c[a]);return"("+c.join("|")+")"},hlSearch:function(){var a=PTL.editor.filter=="search"?PTL.editor.searchText:"",c=[],d={notes:"div.developer-comments",locations:"div.translate-locations",source:"td.translate-original, div.original div.translation-text",target:"td.translate-translation"};b.each(PTL.editor.searchFields,function(e,f){c.push(d[f])});c.length||(c=[d.source,d.target]);b(c.join(", ")).highlightRegex(RegExp(PTL.editor.makeRegexForMultipleWords(a),
"i"))},hlTerms:function(){var a;b(".tm-original").each(function(){a=b(this).text();b("div.original .translation-text").highlightRegex(RegExp(PTL.editor.escapeUnsafeRegexSymbols(a),"g"))})},copyText:function(){var a,c,d;a=b(".tm-translation",this).length?b(".tm-translation",this).text():b(this).text();c=b(PTL.editor.focused);d=c.caret().start+a.length;c.val(c.caret().replace(a));c.caret(d,d)},copyOriginal:function(a){var c=[];b.each(a,function(g){c[g]=b(this).text()});var d=b("[id^=id_target_f_]");
if(d.length){var e=c.length-1;for(a=0;a<d.length;a++){var f=c[a]||c[e];b(d.get(a)).val(f)}d=b(d).get(0);d.focus();PTL.editor.goFuzzy();PTL.editor.cpRE.exec(b(d).val());a=PTL.editor.cpRE.lastIndex;b(d).caret(a,a);PTL.editor.cpRE.lastIndex=0}},getSelectedText:function(){var a="";if(window.getSelection)a=window.getSelection();else if(document.getSelection)a=document.getSelection();else if(document.selection)a=document.selection.createRange().text;return a},escapeHtml:function(a){return a.replace(/&/g,
"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n/,"<br/>")},fancyEscape:function(a){function c(f){var g;g={"\r\n":'<span class="highlight-escape">%s</span>'.replace(/%s/,"\\r\\n")+"<br/>\n","\r":'<span class="highlight-escape">%s</span>'.replace(/%s/,"\\r")+"<br/>\n","\n":'<span class="highlight-escape">%s</span>'.replace(/%s/,"\\n")+"<br/>\n","\t":'<span class="highlight-escape">%s</span>'.replace(/%s/,"\\t")+"\t","&":"&amp;","<":"&lt;",">":"&gt;"}[f];if(g==undefined)g='<span class="highlight-html">&lt;%s&gt;</span>'.replace(/%s/,
f.slice(1,f.length-1));return g}var d=a;a=a.match(this.escapeRE);for(var e in a)d=d.replace(a[e],c(a[e]));return d},doDiff:function(a,c){var d,e,f="",g="",h=this.differencer.diff_main(a,c);this.differencer.diff_cleanupSemantic(h);b.each(h,function(j,i){d=i[0];e=i[1];if(d==0){if(g){f+='<span class="diff-delete">'+PTL.editor.fancyEscape(g)+"</span>";g=""}f+=PTL.editor.fancyEscape(e)}else if(d==1)if(g){f+='<span class="diff-replace">'+PTL.editor.fancyEscape(e)+"</span>";g=""}else f+='<span class="diff-insert">'+
PTL.editor.fancyEscape(e)+"</span>";else if(d==-1)g=e});if(g)f+='<span class="diff-delete">'+PTL.editor.fancyEscape(g)+"</span>";return f},doFuzzyArea:function(){b("tr.edit-row").addClass("fuzzy-unit")},undoFuzzyArea:function(){b("tr.edit-row").removeClass("fuzzy-unit")},doFuzzyBox:function(){b("input.fuzzycheck").attr("checked","checked")},undoFuzzyBox:function(){b("input.fuzzycheck").removeAttr("checked")},goFuzzy:function(){if(!this.isFuzzy()){this.keepState=true;this.doFuzzyArea();this.doFuzzyBox()}},
ungoFuzzy:function(){if(this.isFuzzy()){this.keepState=true;this.undoFuzzyArea();this.undoFuzzyBox()}},isFuzzy:function(){return b("input.fuzzycheck").attr("checked")},doSuggestMode:function(){b("table.translate-table").addClass("suggest-mode")},undoSuggestMode:function(){b("table.translate-table").removeClass("suggest-mode")},isSuggestMode:function(){return b("table.translate-table").hasClass("suggest-mode")},toggleSuggestMode:function(){this.isSuggestMode()?this.undoSuggestMode():this.doSuggestMode()},
showActivity:function(){b("#xhr-error").is(":hidden")&&b("#xhr-activity").show()},hideActivity:function(){b("#xhr-activity").hide()},displayError:function(a){if(a){this.hideActivity();b("#xhr-error span").text(a).parent().stop(true,true).fadeIn(300).delay(2E3).fadeOut(3500)}},error:function(a,c){var d="";d=a.status==0?"Error while connecting to the server.":a.status==500?"Server error.":c=="timeout"?"Server seems down, try again later.":a instanceof XMLHttpRequest?b.parseJSON(a.responseText):"Unknown error.";
PTL.editor.displayError(d)},getReqData:function(){var a={};switch(this.filter){case "checks":if(this.checks.length)a.matchnames=this.checks.join(",");break;case "search":a.search=this.searchText;a.sfields=this.searchFields.length?this.searchFields:["source","target"];break;case "suggestions":a.matchnames="hassuggestion";break;case "mysuggestions":a.matchnames="ownsuggestion";break;case "all":break;case "incomplete":a.unitstates="untranslated,fuzzy";break;default:a.unitstates=this.filter}return a},
getViewUnits:function(a){var c,d;d=this.store?this.store+"/view":this.directory+"view.html";a=b.extend({},{async:false,limit:0,page:this.currentPage,pager:false,withUid:false},a);if(a.limit!=0)d=d+"/limit/"+limit;d=l(d);c={page:a.page};if(Object.size(this.meta)==0)c.meta=true;if(a.pager)c.pager=a.pager;if(a.withUid){c.uid=this.activeUid;delete c.page}c=b.extend(c,this.getReqData());b.ajax({url:d,data:c,dataType:"json",async:a.async,success:function(e){if(Object.size(PTL.editor.meta)==0&&e.meta)PTL.editor.meta=
e.meta;if(a.pager)if(e.pager){PTL.editor.hasResults=true;PTL.editor.pagesGot={};PTL.editor.units={};PTL.editor.updatePager(e.pager);if(e.uid)PTL.editor.activeUid=e.uid}else{PTL.editor.hasResults=false;PTL.editor.displayError("No results.");PTL.editor.checks=PTL.editor.prevChecks;PTL.editor.filter=PTL.editor.prevFilter;b("#filter-status option[value="+PTL.editor.filter+"]").attr("selected","selected")}if(e.units.length){var f=a.withUid&&e.pager?e.pager.number:a.page;PTL.editor.pagesGot[f]=[];b.each(e.units,
function(){PTL.editor.units[this.id]=this;PTL.editor.pagesGot[f].push(this.id)});PTL.editor.hasResults=true}else{PTL.editor.hasResults=false;PTL.editor.displayError("No results.")}},error:PTL.editor.error})},buildRows:function(a){var c,d,e,f="even",g=true,h="";for(d=0;d<a.length;d++){c=a[d].id||a[d];e=this.units[c];h+='<tr id="row'+c+'" class="view-row '+f+'">';h+=this.tmpl.vUnit(b,{data:{meta:this.meta,unit:e}}).join("");h+="</tr>";f=g?"odd":"even";g=!g}return h},buildCtxtRows:function(a){var c,
d,e="even",f=true,g="";for(c=0;c<a.length;c++){d=a[c];g+='<tr id="ctxt'+d.id+'" class="context-row '+e+'">';g+=this.tmpl.vUnit(b,{data:{meta:this.meta,unit:d}}).join("");g+="</tr>";e=f?"odd":"even";f=!f}return g},getUidsBeforeAfter:function(a){var c,d,e,f,g={before:[],after:[]},h=parseInt((this.pager.per_page-1)/2);c=this.units[a];var j={prev:"before",next:"after"};for(d in j){f=c;for(a=0;a<h;a++)if(f[d]!=undefined&&f[d]in this.units){f=this.units[f[d]];g[j[d]].push(f.id)}}if(Object.size(this.units)>
h){e={prev:"after",next:"before"};for(d in j)if(g[e[d]].length<h){c=h-g[e[d]].length;f=this.units[g[j[d]][g[j[d]].length-1]];for(a=0;a<c;a++)if(f[d]!=undefined){f=this.units[f[d]];g[j[d]].push(f.id)}}}g.before.reverse();return g},checkUnitsLinking:function(){var a,c,d,e;for(e in this.pagesGot){e=parseInt(e);a=this.pagesGot[e][0];c=this.pagesGot[e][this.pagesGot[e].length-1];if(e>1&&(!this.units[a].hasOwnProperty("prev")||this.units[a].prev==null)){d=e-1;if(d in this.pagesGot){d=this.pagesGot[d][this.pagesGot[d].length-
1];b.extend(this.units[a],{prev:d})}}if(e<this.pager.num_pages&&(!this.units[c].hasOwnProperty("next")||this.units[c].next==null)){d=e+1;d in this.pagesGot&&b.extend(this.units[c],{next:this.pagesGot[d][0]})}}},displayEditUnit:function(a){var c;this.checkUnitsLinking();if(PTL.editor.hasResults){this.fetchPages(true);c=this.getUidsBeforeAfter(a);a=this.buildRows(c.before)+this.getEditUnit(a)+this.buildRows(c.after);this.reDraw(a)}},reDraw:function(a){var c=b("table.translate-table"),d=b("tbody",c);
b("tr",d).remove();b(".tipsy").remove();d.append(a);b(c).trigger("editor_ready")},fetchPages:function(a){var c;c=this.currentPage;var d=[c,c+1,c-1],e=[];for(c=0;c<d.length;c++)d[c]<=this.pager.num_pages&&d[c]>0&&!(d[c]in this.pagesGot)&&e.push(d[c]);for(c=0;c<e.length;c++)this.getViewUnits({async:a,page:e[c]})},updateBreadcrumbs:function(a,c){if(this.dircrumbs!=a){this.dircrumbs=a;b("#dircrumbs").html(a)}if(this.storecrumbs!=c){this.storecrumbs=c;b("#storecrumbs").html(c)}},updatePager:function(a){this.pager=
a;if(this.currentPage!=a.number||this.currentNumPages!=a.num_pages){this.currentPage=a.number;this.currentNumPages=a.num_pages;b("input#item-number").val(a.number);b("span#items-count").text(a.num_pages)}},createPager:function(a){var c=this.pager;if(b.inArray(a,this.pagesGot[this.currentPage])==-1){for(var d,e=this.currentPage,f=this.currentPage,g=false;!g&&(e>0||f<=this.pager.num_pages);){if(b.inArray(a,this.pagesGot[e])!=-1){d=e;g=true}else if(b.inArray(a,this.pagesGot[f])!=-1){d=f;g=true}e--;f++}if(g)c.number=
d}return c},getEditUnit:function(a){var c;c="edit-row";var d=l("/unit/edit/"+a),e=this.getReqData(),f="",g={before:[],after:[]};b.ajax({url:d,async:false,data:e,dataType:"json",success:function(h){f=h.editor;storecrumbs=h.storecrumbs;dircrumbs=h.dircrumbs;PTL.editor.updateBreadcrumbs(dircrumbs,storecrumbs);PTL.editor.updatePager(PTL.editor.createPager(a));if(h.ctxt){PTL.editor.ctxtGap=2;g.before=h.ctxt.before;g.after=h.ctxt.after}},error:PTL.editor.error});c+=this.units[a].isfuzzy?" fuzzy-unit":"";
c=(g.before.length?'<tr class="more-context before"><td colspan="2"><a class="morecontext">Show more context rows</a></td></tr>':"")+this.buildCtxtRows(g.before)+'<tr id="row'+a+'" class="'+c+'">'+f+"</tr>"+this.buildCtxtRows(g.after)+(g.after.length?'<tr class="more-context after"><td colspan="2"><a class="morecontext">Show more context rows</a></td></tr>':"");this.activeUid=a;return c},processSubmit:function(a,c){a.preventDefault();var d,e,f,g=PTL.editor.activeUid;if(c==undefined){c=b(a.target).attr("class");
d="translate"}else d="captcha";f={submit:"submission",suggest:"suggestion"}[c];e=l("/unit/process/"+g+"/"+f);d=b("form#"+d).serializeObject();b.extend(d,PTL.editor.getReqData());b.ajax({url:e,type:"POST",data:d,dataType:"json",async:false,success:function(h){if(h.captcha){b.fancybox(h.captcha);b("input#id_captcha_answer").focus()}else{if(f=="submission"){PTL.editor.units[g].isfuzzy=PTL.editor.isFuzzy();b("textarea[id^=id_target_f_]").each(function(j){PTL.editor.units[g].target[j].text=b(this).val()})}if(h=
parseInt(PTL.editor.units[g].next)){h=PTL.utils.updateHashPart("unit",h,["page"]);b.history.load(h)}else PTL.editor.displayError("Congratulations, you walked through all items")}},error:PTL.editor.error})},gotoPrevNext:function(a){a.preventDefault();var c=PTL.editor.units[PTL.editor.activeUid];c={previous:c.prev,next:c.next}[b(a.target).attr("class")];if(c!=null){a=PTL.utils.updateHashPart("unit",parseInt(c),["page"]);b.history.load(a)}else b(a.target).attr("class")=="previous"?PTL.editor.displayError("You reached the beginning of the list"):
PTL.editor.displayError("You reached the end of the list")},gotoUnit:function(a){a.preventDefault();if(PTL.editor.getSelectedText()=="")if(a=b(this).attr("id").match(/row([0-9]+)/)){a=parseInt(a[1]);a=PTL.utils.updateHashPart("unit",a,["page"]);b.history.load(a)}},gotoPage:function(){var a=parseInt(b("input#item-number").val());if(a&&!isNaN(a)&&a>0&&a<=PTL.editor.pager.num_pages){a=PTL.utils.updateHashPart("page",a,["unit"]);b.history.load(a)}},getCheckOptions:function(){var a,c=this.store?l(this.store+
"/checks/"):l(this.directory+"checks.html");b.ajax({url:c,async:false,dataType:"json",success:function(d){a=d.checks},error:PTL.editor.error});return a},filterChecks:function(){if(!PTL.editor.preventNavigation){var a=b("option:selected",this).val();a!="none"&&b.history.load("filter=checks,"+a)}},filterStatus:function(){var a=b("div#filter-status option:selected").val();if(a=="checks"){a=PTL.editor.getCheckOptions();if(a.length){var c='<div id="filter-checks" class="toolbar-item">';c+='<select name="filter-checks">';
c+='<option selected="selected" value="none">------</option>';b.each(a,function(){c+='<option value="'+this.name+'">'+this.text+"</option>"});c+="</select></div>";b("div#filter-status").first().after(c)}else{PTL.editor.displayError("No results.");b("#filter-status option[value="+PTL.editor.filter+"]").attr("selected","selected")}}else{b("div#filter-checks").remove();PTL.editor.preventNavigation||b.history.load("filter="+a)}},getMoreContext:function(){var a=l("/unit/context/"+PTL.editor.activeUid);
reqData={gap:PTL.editor.ctxtGap};b.ajax({url:a,async:false,dataType:"json",data:reqData,success:function(c){PTL.editor.ctxtGap+=2;var d=PTL.editor.buildCtxtRows(c.ctxt.before);c=PTL.editor.buildCtxtRows(c.ctxt.after);var e=b("tr.context-row");e.first().before(d);e.last().after(c)},error:PTL.editor.error})},parseSearch:function(a){var c=[],d=a;if(this.searchRE.test(a)){var e,f=[],g=a.split(" ");b.each(g,function(h,j){if(PTL.editor.searchRE.test(j)){e=j.split(":")[1];b.inArray(e,PTL.editor.searchOptions)>
-1&&c.push(e);f.push(h)}});b.each(f.reverse(),function(h,j){g.splice(j,1)});d=encodeURIComponent(g.join(" "))}else{d=encodeURIComponent(d);b("div.advancedsearch input:checked").each(function(){c.push(b(this).val())})}if(c.length)d+="&sfields="+c.join(",");return d},search:function(){var a=b("input#id_search").val();a=a?"search="+this.parseSearch(a):PTL.utils.updateHashPart("filter","all",["search","sfields"]);b.history.load(a)},filterTMResults:function(a){for(var c=b("[id^=id_source_f_]").first().val(),
d=[],e=0;e<a.length&&e<3;e++){a[e].source=this.doDiff(c,a[e].source);a[e].target=this.fancyEscape(a[e].target);a[e].qTitle=Math.round(a[e].quality)+"% match";d.push(a[e])}return d},getTMUnits:function(){var a=this.meta.source_lang,c=this.meta.target_lang,d=b(b("input[id^=id_source_f_]").get(0)).val();a=this.settings.tmUrl+a+"/"+c+"/unit/"+encodeURIComponent(d)+"?jsoncallback=?";this.tmReq!=null&&this.tmReq.abort();this.tmReq=b.jsonp({url:a,callback:"_jsonp"+PTL.editor.activeUid,dataType:"jsonp",success:function(e){if(this.callback.slice(6)==
PTL.editor.activeUid&&e.length>0){e=PTL.editor.filterTMResults(e);e=PTL.editor.tmpl.tm(b,{data:{meta:PTL.editor.meta,suggs:e,name:"amaGama server"}}).join("");b("div#suggestion-container").append(e);b("div#amagama_results").animate({height:"show"},1E3,"easeOutQuad")}},error:PTL.editor.error})},rejectSuggestion:function(){var a=b(this).parent(),c=b(".translate-container input#id_id").val(),d=b(this).siblings("input.suggid").val();c=l("/suggestion/reject/")+c+"/"+d;b.post(c,{reject:1},function(){a.fadeOut(200,
function(){b(this).remove();b("div#suggestion-container div[id^=suggestion]").length||b("input.next").trigger("click")})},"json")},acceptSuggestion:function(){var a=b(this).parent(),c=b(".translate-container input#id_id").val(),d=b(this).siblings("input.suggid").val();d=l("/suggestion/accept/")+c+"/"+d;b.post(d,{accept:1},function(e){b.each(e.newtargets,function(f,g){b("textarea#id_target_f_"+f).val(g).focus()});b.each(e.newdiffs,function(f,g){b.each(g,function(h,j){b("#suggdiff-"+f+"-"+h).html(j)})});
b("textarea[id^=id_target_f_]").each(function(f){PTL.editor.units[c].target[f].text=b(this).val()});PTL.editor.units[c].isfuzzy=false;a.fadeOut(200,function(){b(this).remove();b("div#suggestion-container div[id^=suggestion]").length||b("input.next").trigger("click")})},"json")},rejectCheck:function(){var a=b(this).parent(),c=b(this).siblings("input.checkid").val(),d=b(".translate-container input#id_id").val();c=l("/qualitycheck/reject/")+d+"/"+c;b.post(c,{reject:1},function(){a.fadeOut(200,function(){b(this).remove()})},
"json")},isSupportedSource:function(a,c){for(var d in a)if(c==a[d].source)return true;return false},isSupportedTarget:function(a,c){for(var d in a)if(c==a[d].target)return true;return false},isSupportedPair:function(a,c,d){for(var e in a)if(c==a[e].source&&d==a[e].target)return true;return false},addMTButton:function(a,c,d,e){c='<a class="translate-mt '+c+'">';c+='<img src="'+d+'" title="'+e+'" /></a>';b(a).first().prepend(c)},addMTButtons:function(a){if(this.isSupportedTarget(a.pairs,a.targetLang)){var c=
this,d=b(".translate-toolbar");b(d).each(function(){var e=c.normalizeCode(b(this).parent().parent().find(".translation-text").attr("lang"));(a.validatePairs?c.isSupportedPair(a.pairs,e,a.targetLang):c.isSupportedSource(a.pairs,e))&&c.addMTButton(this,a.buttonClassName,a.imageUri,a.hint+" ("+e.toUpperCase()+"&rarr;"+a.targetLang.toUpperCase()+")")})}},normalizeCode:function(a){var c=a.replace("_","-");a=a.indexOf("@");if(a!=-1)c=c.slice(0,a);return c},collectArguments:function(a){this.argSubs[this.argPos]=
a;return"["+this.argPos++ +"]"},translate:function(a,c){var d=b("[id^=id_target_f_]"),e=b(a).parent().parent().parent().find(".translation-text"),f=PTL.editor.normalizeCode(e.eq(0).attr("lang")),g=PTL.editor.normalizeCode(d.eq(0).attr("lang")),h=/<[\/]?\w+.*?>/g,j=/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuidfegEG])/g,i=/{\d+(,\d+)?(:[a-zA-Z ]+)?}/g,n=/%\d+/g,k=this;b(e).each(function(t){var s=b(this).text();k.argSubs=[];k.argPos=0;s=s.replace(h,function(v){return k.collectArguments(v)});
s=s.replace(j,function(v){return k.collectArguments(v)});s=s.replace(i,function(v){return k.collectArguments(v)});s=s.replace(n,function(v){return k.collectArguments(v)});c(s,f,g,function(v,z){if(v===false)PTL.editor.displayError(z);else{for(var w=0;w<k.argSubs.length;w++){if(s.match(RegExp("\\["+w+"\\][^\\s]")))v=v.replace(RegExp("\\["+w+"\\]\\s+"),"["+w+"]");if(s.match(RegExp("[^\\s]\\["+w+"\\]")))v=v.replace(RegExp("\\s+\\["+w+"\\]"),"["+w+"]")}for(w=0;w<k.argSubs.length;w++){var u=k.argSubs[w].replace(/\&/g,
"&amp;").replace(/\</g,"&lt;").replace(/\>/g,"&gt;");v=v.replace("["+w+"]",u)}d.eq(t).val(b("<div />").html(v).text());d.eq(t).focus()}})});PTL.editor.goFuzzy();return false}}})(jQuery);if(!this.JSON)this.JSON={};
(function(){function b(i){return i<10?"0"+i:i}function a(i){e.lastIndex=0;return e.test(i)?'"'+i.replace(e,function(n){var k=h[n];return typeof k==="string"?k:"\\u"+("0000"+n.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+i+'"'}function c(i,n){var k,t,s,v,z=f,w,u=n[i];if(u&&typeof u==="object"&&typeof u.toJSON==="function")u=u.toJSON(i);if(typeof j==="function")u=j.call(n,i,u);switch(typeof u){case "string":return a(u);case "number":return isFinite(u)?String(u):"null";case "boolean":case "null":return String(u);
case "object":if(!u)return"null";f+=g;w=[];if(Object.prototype.toString.apply(u)==="[object Array]"){v=u.length;for(k=0;k<v;k+=1)w[k]=c(k,u)||"null";s=w.length===0?"[]":f?"[\n"+f+w.join(",\n"+f)+"\n"+z+"]":"["+w.join(",")+"]";f=z;return s}if(j&&typeof j==="object"){v=j.length;for(k=0;k<v;k+=1){t=j[k];if(typeof t==="string")if(s=c(t,u))w.push(a(t)+(f?": ":":")+s)}}else for(t in u)if(Object.hasOwnProperty.call(u,t))if(s=c(t,u))w.push(a(t)+(f?": ":":")+s);s=w.length===0?"{}":f?"{\n"+f+w.join(",\n"+f)+
"\n"+z+"}":"{"+w.join(",")+"}";f=z;return s}}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()}}var d=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
e=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,f,g,h={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},j;if(typeof JSON.stringify!=="function")JSON.stringify=function(i,n,k){var t;g=f="";if(typeof k==="number")for(t=0;t<k;t+=1)g+=" ";else if(typeof k==="string")g=k;if((j=n)&&typeof n!=="function"&&(typeof n!=="object"||typeof n.length!=="number"))throw Error("JSON.stringify");return c("",
{"":i})};if(typeof JSON.parse!=="function")JSON.parse=function(i,n){function k(s,v){var z,w,u=s[v];if(u&&typeof u==="object")for(z in u)if(Object.hasOwnProperty.call(u,z)){w=k(u,z);if(w!==undefined)u[z]=w;else delete u[z]}return n.call(s,v,u)}var t;i=String(i);d.lastIndex=0;if(d.test(i))i=i.replace(d,function(s){return"\\u"+("0000"+s.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(i.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){t=eval("("+i+")");return typeof n==="function"?k({"":t},""):t}throw new SyntaxError("JSON.parse");}})();(function(){jQuery.each({getSelection:function(){var b=this.jquery?this[0]:this;return("selectionStart"in b&&function(){var a=b.selectionEnd-b.selectionStart;return{start:b.selectionStart,end:b.selectionEnd,length:a,text:b.value.substr(b.selectionStart,a)}}||document.selection&&function(){b.focus();var a=document.selection.createRange();if(a==null)return{start:0,end:b.value.length,length:0};var c=b.createTextRange(),d=c.duplicate();c.moveToBookmark(a.getBookmark());d.setEndPoint("EndToStart",c);return{start:d.text.length,
end:d.text.length+a.text.length,length:a.text.length,text:a.text}}||function(){return{start:0,end:b.value.length,length:0}})()},replaceSelection:function(b){var a=this.jquery?this[0]:this,c=b||"";return("selectionStart"in a&&function(){a.value=a.value.substr(0,a.selectionStart)+c+a.value.substr(a.selectionEnd,a.value.length);return this}||document.selection&&function(){a.focus();document.selection.createRange().text=c;return this}||function(){a.value+=c;return this})()}},function(b){jQuery.fn[b]=
this})})();(function(b,a,c,d){b.fn.caret=function(e,f){var g,h,j=this[0],i=b.browser.msie;if(typeof e==="object"&&typeof e.start==="number"&&typeof e.end==="number"){g=e.start;h=e.end}else if(typeof e==="number"&&typeof f==="number"){g=e;h=f}else if(typeof e==="string")if((g=j.value.indexOf(e))>-1)h=g+e[a];else g=null;else if(Object.prototype.toString.call(e)==="[object RegExp]"){var n=e.exec(j.value);if(n!=null){g=n.index;h=g+n[0][a]}}if(typeof g!="undefined"){if(i){i=this[0].createTextRange();i.collapse(true);
i.moveStart("character",g);i.moveEnd("character",h-g);i.select()}else{this[0].selectionStart=g;this[0].selectionEnd=h}this[0].focus();return this}else{if(i){h=document.selection;if(this[0].tagName.toLowerCase()!="textarea"){i=this.val();g=h[c]()[d]();g.moveEnd("character",i[a]);var k=g.text==""?i[a]:i.lastIndexOf(g.text);g=h[c]()[d]();g.moveStart("character",-i[a]);var t=g.text[a]}else{g=h[c]();h=g[d]();h.moveToElementText(this[0]);h.setEndPoint("EndToEnd",g);k=h.text[a]-g.text[a];t=k+g.text[a]}}else{k=
j.selectionStart;t=j.selectionEnd}g=j.value.substring(k,t);return{start:k,end:t,text:g,replace:function(s){return j.value.substring(0,k)+s+j.value.substring(t,j.value[a])}}}}})(jQuery,"length","createRange","duplicate");(function(b){b.fn.highlightRegex=function(a){a==undefined||a.source==""?b(this).find("span.highlight").each(function(){b(this).replaceWith(b(this).text());b(this).parent().each(function(){node=b(this).get(0);node.normalize&&node.normalize()})}):b(this).each(function(){elt=b(this).get(0);elt.normalize();b.each(b.makeArray(elt.childNodes),function(c,d){if(d.nodeType==3)for(var e=d;(pos=e.data.search(a))>=0;){match=e.data.slice(pos).match(a)[0];if(match.length==0)break;var f=document.createElement("span");
f.className="highlight";var g=e.splitText(pos);e=g.splitText(match.length);var h=g.cloneNode(true);f.appendChild(h);e.parentNode.replaceChild(f,g)}else b(d).highlightRegex(a)})});return b(this)}})(jQuery);(function(b,a){b.fn.serializeObject=function(){var c={};b.each(this.serializeArray(),function(d,e){var f=e.name,g=e.value;c[f]=c[f]===a?g:b.isArray(c[f])?c[f].concat(g):[c[f],g]});return c}})(jQuery);
